<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>JW Player Clickable Demo</title>
	<link rel="stylesheet" href="../css/style.css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	   <script type="text/javascript" src="http://content.jwplatform.com/libraries/nWvdqK5e.js"></script>
       
<link rel='SHORTCUT ICON' type='image/ico' href='https://jwplayer.desk.com/customer/portal/theme_attachments/16139?cb=1389736032397' />
<link rel='icon' type='image/png' href='https://jwplayer.desk.com/customer/portal/theme_attachments/16139?cb=1389736032397' />

<style> .jw-reset{
  text-transform: none;
}
</style>
	 <script>
  		$(document).ready(function(){
	
	$('ul.tabs li').click(function(){
		var tab_id = $(this).attr('data-tab');

		$('ul.tabs li').removeClass('current');
		$('.tab-content').removeClass('current');

		$(this).addClass('current');
		$("#"+tab_id).addClass('current');
	});

});
  </script>

</head>


<body>

		<header>
			<div class="left"><img src="../img/jw-logo.svg" alt="jw player"></div>
			<div class="right"><h2>Clickable Player Demo</h2></div>
		</header>
	
		<div class="hero">
			<div class="logos">
				<img src="../img/jw-swoosh.svg" alt="jw player">	
			</div>
		</div>	

		<div class="features">
			
			<ul class="tabs">
				<li class="tab-link current" data-tab="tab-1"><a href="#">Adaptive Streaming</a></li>
				<li class="tab-link" data-tab="tab-2"><a href="#">Closed Captions</a></li>
				<li class="tab-link" data-tab="tab-3"><a href="#">HLS AES Token</a></li>
        <li class="tab-link" data-tab="tab-4"><a href="#">Live</a></li>
				<li class="tab-link" data-tab="tab-5"><a href="#">HLSV4 Audio Tracks</a></li>
				<li class="tab-link" data-tab="tab-6"><a href="#">MPEG-DASH</a></li>
			</ul>
			

			<div id="tab-1" class="tab-content current">
				<div class="player">

          <div id="overlay">Current bandwidth: <strong id="bandwidth">0 kbps</strong></div>
          <div id="container-2"></div>
            <table id="grid"></table>

          <script type="text/javascript">
              // BOTR video to play
              var file = "vM7nH0Kl";
              // Table to push fragments into
var grid = document.getElementById("grid");
// List with preview thumbs
var thumbnails = [];
// Latest bandwidth;
var bandwidth = 0;
// List of loaded fragments
var fragments = [];
// List of current quality levels
var levels = [];
// Position of the leftmost fragment
var starttime = 0;
// Correct for extra quickstart ping in jwp
var quickstart;
// Number of table colums to show
var columns = 8;
// Current quality level
var current = 0;


/** Setup JW Player. **/
jwplayer("container-2").setup({
    file: 'http://content.jwplatform.com/manifests/'+file+'.m3u8',

  tracks: [{
    kind: "thumbnails", file: 'http://content.jwplatform.com/strips/'+file+'-120.vtt' 
  }],
    autostart: true,
    primary: "flash",
    stretching:"fill",
    width: 860,
    height: 384
});

grid.addEventListener("click",function(event) {
  var b = event.target.innerHTML.split(" ")[0];
  for(var i=0; i<levels.length; i++) {
    var d = Math.round(levels[i]['bitrate']/1024);
    if(b == d) {
      if(i == current - 1) {
        jwplayer().setCurrentQuality(0);
      } else {
        jwplayer().setCurrentQuality(i+1);
      }
      break;
    }
  }
});
/** Check if player is in Flash mode **/
jwplayer().onReady(function(event) {
  if(jwplayer().getProvider() == "html5") {
    jwplayer().remove();
    var c = document.getElementById("container-2");
    c.innerHTML = "This demo only works in desktop browsers!";
  }
});


/** Playlist ready: load VTT thumbnails. **/
jwplayer().onPlaylist(function(event) {
  starttime = 0;
  thumbnails = [];
  if(file.length == 8) {
    var r = new XMLHttpRequest();
    r.onreadystatechange = function() {
      if (r.readyState == 4 && r.status == 200) {
        var t = r.responseText.split("\n\n");
        for(var i=1; i<t.length-1; i++) {
          thumbnails.push(parse(t[i]));
        }
      }
    };
    r.open('GET','http://content.jwplatform.com/strips/'+file+'-120.vtt',true);
    r.send();
  }
});
function parse(d) {
    var a = d.split("\n");
    var i = a[0].indexOf(' --> ');
    var g = a[1].substr(a[1].indexOf('=')+1).split(',');
    return {
      begin: seconds(a[0].substr(0,i)),
      end: seconds(a[0].substr(i+5)),
      left: Number(g[0]),
      top: Number(g[1])
    }
};
function seconds(s) {
  var a = s.split(':');
  return  Number(a[a.length-1]) + Number(a[a.length-2]) * 60;
};


/** Manifest loaded, quality levels broadcasted. **/
jwplayer().onQualityLevels(function(event) {
  current = event.currentQuality;
  levels = event.levels;
  if(levels.length > 1) { levels.shift(); }
  render();
});
function render() {
  fragments = [];
  grid.innerHTML = '';
  for (var i=0; i<levels.length; i++) {
    var r = grid.insertRow(i);
    for (var j=0; j<columns; j++) {
      var c = r.insertCell();
      c.innerHTML = Math.round(levels[i].bitrate/1024)+' kbps';
      if(current > 0 && i != current-1) {
        c.style.backgroundColor = "#ddd";
      }
    }
  }
};


/** Fragment loaded: show thumbnail and bandwidth. **/
jwplayer().onMeta(function(event) {
  if(event.metadata.bandwidth){
    var b = Math.round(event.metadata.bandwidth/1024);
    var l = Number(event.metadata.currentLevel.substr(0,1));
    if (b != bandwidth) {
      bandwidth = b;
      if(!quickstart) {
        quickstart = true;
        return;
      }
      if(fragments.length>columns-2) { scroll(); }
      fragments.push(l);
      var c = grid.rows[l-1].cells[fragments.length-1];
      c.innerHTML = "";
      c.style.backgroundColor = "#000";
      if(thumbnails.length) {
        var t = find((fragments.length-1)*10+1);
        c.style.backgroundImage = 'url(http://content.jwplatform.com/strips/'+file+'-120.jpg)';
        c.style.backgroundPosition = '-' + thumbnails[t].left + 'px -' + thumbnails[t].top + 'px';
        c.style.cursor = "default";
      }
      var s = String(b);
      if(s.length > 3) { s = s.substr(0,s.length-3) + "," + s.substr(-3); }
      document.getElementById("bandwidth").innerHTML = s +" kbps";
    }
  }
});
function scroll() {
  for (var i=0; i<levels.length; i++) {
    var c = grid.rows[i].insertCell(fragments.length);
    c.innerHTML = Math.round(levels[i].bitrate/1024)+' kbps';
    if(current > 0 && i != current-1) {
      c.style.backgroundColor = "#ddd";
    }
    grid.rows[i].deleteCell(0);
  }
  fragments.shift();
  starttime += 10;
}
function find(p) {
  for(var i=0; i<thumbnails.length; i++) {
    if (starttime + p < thumbnails[i].end) {
      return i;
    }
  }
}


/** Time updated: set position **/
jwplayer().onTime(function(event) {
  var i = Math.floor((event.position-starttime)/10);
  if(fragments.length) {
    var c = grid.rows[fragments[i]-1].cells[i];
    c.className = "play";
    var p = Math.ceil(event.position%10*5)*2;
    c.innerHTML = "<div style='width:"+p+"%'></div>";
  }
});


/** Reload grid when updating quality, seeking or completing. **/
jwplayer().onSeek(function(event) {
  starttime = Math.floor(event.offset/10)*10;
  render();
});
jwplayer().onQualityChange(function(event) {
  current = event.currentQuality;
  starttime = Math.floor(jwplayer().getPosition()/10)*10;
  render();
});
jwplayer().onComplete(function(event) {
  starttime = 0;
  render();
});
</script>

      </div>
			</div>

			<div id="tab-2" class="tab-content">

        <ol>
          <li>CEA-608 captions</li>
          <li>WebVTT captions on all devices</li>
          <li>Multiple language support</li>
          <li>Can be styled any way</li>
          <li>Toggle with visual interface or API</li>
        </ol>

        <div class="player">
          <iframe src="http://demo.jwplayer.com/captions/index.html" width="660" height="420"></iframe>
        </div>
  </div>

			<div id="tab-3" class="tab-content">
				<ol>
					<li>Able to pass a token with key request</li>
					<li>More secure</li>
					<li>Works on all Desktop browsers</li>
					<li>Integrates with Key servers</li>
					<li>Can use current Authorization</li>
				</ol>

				<div class="player">
					<div id="container-3">&nbsp;</div>
<script>
 jwplayer("container-3").setup({
            file: 'http://ams-samplescdn.streaming.mediaservices.windows.net/c1275bed-9977-40ca-bb27-91bc783c040b/sintel_trailer-1080p.ism/manifest(format=m3u8-aapl)',
            androidhls:"true",
            aestoken:"Bearer%3durn%253amicrosoft%253aazure%253amediaservices%253acontentkeyidentifier%3d8ca714da-5404-4617-9fc2-3ea58d88667f%26Audience%3durn%253atest%26ExpiresOn%3d2281559228%26Issuer%3dhttp%253a%252f%252ftestacs.com%252f%26HMACSHA256%3dpimqYZll8uFqSYYFX6AOxAbHH6epEgsn1Y%252f%252bJnOdCLc%253d",
    aspectratio:"2.35:1",
    width: 640,
      height: 320
        });
</script>
<pre class="notranslate">jwplayer("myElement").setup({
  file: 'sample_aes_stream.m3u8',
  aestoken: 'EXAMPLE_AES_TOKEN'
});
</pre>

				</div>
  </div>

  <div id="tab-4" class="tab-content">
      <ol>
          <li>Stream live events</li>
          <li>Works with Wowza, Azure, Unified Streaming and many more</li>
          <li>Adaptive Bitrate in Live</li>
          <li>Provide sliding window DVR</li>
      </ol>
        
          <div class="player">
          <iframe src="http://demo.jwplayer.com/live/index.html" width="660" height="420"></iframe>
        </div>
    </div>

			<div id="tab-5" class="tab-content">
      <ol>
          <li>Useful for director's commentary</li>
          <li>Multiple language support</li>
          <li>Different audio perspectives</li>
          <li>JW Player will select system language</li>
          <li>Easier to serve, smaller file sizes</li>
          <li>Alternate audio qualities</li>
          <li>Toggle with visual interface or API</li>
        </ol>

				<div class="player">
					<div id="container-4"></div>
					<script>
            jwplayer("container-4").setup({
  
            file: 'http://wowzaec2demo.streamlock.net/vod-multitrack/_definst_/smil:ElephantsDream/ElephantsDream.smil/playlist.m3u8',
            title: 'Wowza - Elephants Dream',            
            androidhls:"true",
            stagevideo:"false",
            primary:"flash",
            width:640,
            height:360,
              hlslabels: {
                  "350": "Lowest",
                  "450": "Low",
                  "900": "Medium",
                  "2000": "High"
              }
            });
          </script>
	       </div>
			</div>

<div id="tab-6" class="tab-content">
      <ol>
          <li>Industry standard for adaptive streaming</li>
          <li>HTML5 for mobile and desktop</li>
          <li>Faster starts and seeks</li>
          <li>Easy file management</li>
          <li>Will support VP9</li>
        </ol>
				
				<div class="player">
	<div id="container-5"></div>
    <script>
        jwplayer('container-5').setup({
           playlist:[{
            file:"http://wowzaec2demo.streamlock.net/vod-multitrack/_definst_/smil:ElephantsDream/ElephantsDream.smil/manifest.mpd",
            title:"Sintel",
            description:"This is a DASH stream!",
            type:"dash"
        }],
            dash: 'shaka',
            skin:{
              //active:"",
              name:"seven",
              background:"#2c364f",
              //inactive:""
            },
            width: 640,
            height: 360

            //autostart": true
        });
    </script>

				</div>
				</div>

	</div>

	
</body>
</html>